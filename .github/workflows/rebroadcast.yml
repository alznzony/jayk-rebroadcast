name: Re-Broadcast Orders

on:
  schedule:
    - cron: "* * * * *"     # ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
  workflow_dispatch:         # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ

jobs:
  run-rebroadcast:
    runs-on: ubuntu-latest

    steps:
      - name: Call Re-Broadcast Function
        run: |
          echo "ðŸš€ Calling Re-Broadcast Function..."

          RESPONSE=$(curl -s -o response.txt -w "%{http_code}" \
            -X POST \
            -H "x-function-key: ${{ secrets.FUNCTIONS_PASS_KEY }}" \
            https://gxnokzufjkioldjfgowk.supabase.co/functions/v1/rebroadcast_pending_orders
          )

          echo "ðŸ“¡ HTTP Status = $RESPONSE"
          echo "----- Response Body -----"
          cat response.txt
