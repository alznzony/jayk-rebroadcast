name: Rebroadcast Pending Orders

on:
  schedule:
    - cron: "*/1 * * * *"   # كل دقيقة
  workflow_dispatch:

jobs:
  rebroadcast:
    runs-on: ubuntu-latest

    steps:
      - name: Call Supabase Re-Broadcast Function
        run: |
          echo "Calling Re-broadcast Function..."
          RESPONSE=$(curl -s -X POST "${{ secrets.SUPABASE_URL }}/functions/v1/rebroadcast_pending_orders")
          echo "Response:"
          echo "$RESPONSE"
